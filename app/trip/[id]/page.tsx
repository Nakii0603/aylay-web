"use client";

import ClientNav from "@/components/ClientNav";
import { useParams } from "next/navigation";
import { useState } from "react";

interface Friend {
  name: string;
  paid: boolean;
  joined: boolean;
}

export default function TripDetailPage() {
  const { id } = useParams();

  const [friends] = useState<Friend[]>([
    { name: "–ë–∞—Ç–∞–∞", paid: true, joined: true },
    { name: "–°–∞—Ä–∞–∞", paid: true, joined: true },
    { name: "–ú”©–Ω—Ö”©”©", paid: true, joined: true },
    { name: "–ù–∞—Ä–∞–∞", paid: false, joined: false },
  ]);

  const paymentPerFriend = 500_000;
  const numberOfFriends = friends.length;

  // –ù–∏–π—Ç —Ç”©–ª—Å”©–Ω –º”©–Ω–≥”©
  const totalCollected =
    friends.filter((friend) => friend.paid).length * paymentPerFriend;

  // –•“Ø“Ø–≥–∏–π–Ω —Ç–æ–æ—Ü–æ–æ (–∂–∏–ª–∏–π–Ω 5%, 30 —Ö–æ–Ω–æ–≥)
  const interestRateAnnual = 0.05;
  const days = 30;
  const dailyRate = interestRateAnnual / 365;

  const calculateInterest = (amount: number) => {
    return amount * Math.pow(1 + dailyRate, days);
  };

  const totalWithInterest = calculateInterest(totalCollected);

  // –¢–æ—Ä–≥—É—É–ª—å –±–æ–¥–æ—Ö: —Ç”©–ª—Å”©–Ω —á —è–≤–∞–∞–≥“Ø–π - 50–ö, —Ç”©–ª”©”©–≥“Ø–π & —è–≤–∞–∞–≥“Ø–π - 25–ö
  const getPenalty = (friend: Friend) => {
    if (!friend.joined && friend.paid) return 50_000;
    if (!friend.joined && !friend.paid) return 25_0000;
    return 0;
  };

  const totalPenalties = friends.reduce(
    (sum, friend) => sum + getPenalty(friend),
    0
  );

  return (
    <div className="p-6 bg-gray-100 min-h-screen">
      <div className="max-w-2xl mx-auto bg-white p-6 rounded shadow">
        <h1 className="text-xl font-bold mb-4">
          üß≠ –ê—è–ª–ª—ã–Ω –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π (ID: {id})
        </h1>

        <ul className="space-y-2 mb-6">
          {friends.map((friend, index) => (
            <li
              key={index}
              className="flex justify-between bg-gray-100 p-3 rounded border"
            >
              <span className="font-semibold">{friend.name}</span>
              <span>
                {friend.paid ? "üí∞ –¢”©–ª—Å”©–Ω" : "‚ùå –¢”©–ª”©”©–≥“Ø–π"} |{" "}
                {friend.joined ? "‚úÖ –ò—Ä—Å—ç–Ω" : "üö´ –Ø–≤–∞–∞–≥“Ø–π"} | –¢–æ—Ä–≥—É—É–ª—å:{" "}
                <span className="font-mono">
                  {getPenalty(friend).toLocaleString()}‚ÇÆ
                </span>
              </span>
            </li>
          ))}
        </ul>

        <div className="text-sm space-y-2">
          <p>
            üë• <strong>–ù–∏–π—Ç –Ω–∞–π–∑—É—É–¥—ã–Ω —Ç–æ–æ:</strong> {numberOfFriends}
          </p>
          <p>
            üíµ <strong>–ù—ç–≥ —Ö“Ø–Ω–∏–π —Ç”©–ª”©—Ö –¥“Ø–Ω:</strong>{" "}
            {paymentPerFriend.toLocaleString()}‚ÇÆ
          </p>
          <p>
            üí∞ <strong>–ù–∏–π—Ç —Ü—É–≥–ª–∞—Å–∞–Ω –º”©–Ω–≥”©:</strong>{" "}
            {totalCollected.toLocaleString()}‚ÇÆ
          </p>
          <p>
            üìà <strong>–•“Ø“Ø—Ç—ç–π –¥“Ø–Ω (30 —Ö–æ–Ω–æ–≥):</strong>{" "}
            {totalWithInterest.toFixed(0).toLocaleString()}‚ÇÆ
          </p>
          <p>
            ‚ö†Ô∏è <strong>–ù–∏–π—Ç —Ç–æ—Ä–≥—É—É–ª—å:</strong> {totalPenalties.toLocaleString()}
            ‚ÇÆ
          </p>
        </div>
      </div>
      <ClientNav />
    </div>
  );
}
